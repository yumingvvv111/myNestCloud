version: '2'

services:
  # node-user:
  #   build: ./nt-module-user/
  #   ports:
  #    - "50051:50051"
    # depends_on:
    #  - "security"
    # volumes:
    #  - "$PWD/nginx.conf:/etc/nginx/conf.d/nginx"
    #  - "$PWD/account-system/app/public:/usr/share/nginx/html"
    # networks:
    #  - app_net
        # 容器名称
    # container_name: "node-user"
  node-demo:
    build: ./nt-rpc-demo/
    ports:
     - "50050:50050"
    # depends_on:
    #  - "security"
    # volumes:
    #  - "$PWD/nginx.conf:/etc/nginx/conf.d/nginx"
    #  - "$PWD/account-system/app/public:/usr/share/nginx/html"
    # networks:
    #  - app_net
        # 容器名称
    container_name: "node-demo"
    
  # security:
  #   image: node:8.4-alpine
  #   ports:
  #   #  - "8080:8080"
  #    - "7001:7001"
  #   expose:
  #    - "7001"
  #   #  - "8080"
  #   depends_on:
  #    - db
  #   environment:
  #    - DATABASE_HOST=db
  #    - NODE_ENV=production
  #   volumes:
  #    - ./account-system/:/account-system
  #   # working_dir: /account-system
  #   # command: sh -c "cd /account-system && npm install && npm run dev"
  #   command: sh -c "cd /account-system && npm install --production && npm run start"
  #   container_name: account-system
  #   restart: always
  #   networks:
  #           - app_net
  # db:
  #   image: postgres
  #   networks:
  #           app_net:
  #               # 固定子网ip，网段必须在子网络10.10.*.*
  #               ipv4_address: 10.10.10.1
  #   environment:
  #    - POSTGRES_PASSWORD=cctv7788
  #    - POSTGRES_DB=module_user
  #    - POSTGRES_USER=postgres
  #    - POSTGRES_PASSWORD=cctv7788
  #   container_name: db
  #   restart: always
  #   ports:
  #    - "5432:5432"
  #   expose:
  #    - "5432"
  #   volumes:
  #    - ./accountingsystem.sql/:/docker-entrypoint-initdb.d/init.sql
  #   command: mysqld --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci
    # command: [
    #   "--log-bin=mysql-bin",
    #   "--character-set-server=utf8mb4",
    #   "--collation-server=utf8mb4_unicode_ci",
    #   "--innodb_flush_log_at_trx_commit=1",
    #   "--sync_binlog=1"
    #   ]
    